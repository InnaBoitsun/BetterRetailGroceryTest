@helper Pagination(int pageCurrent, int pageCount, int groupsize, string baseUrl, string pageQueryKey = "page")
{
    var queryString = baseUrl.IndexOf("?") > 0 ? baseUrl.Split('?')[1] : string.Empty;

    if (!string.IsNullOrEmpty(queryString))
    {
        baseUrl = baseUrl.Split('?')[0];
        var parameters = HttpUtility.ParseQueryString(queryString);
        if (parameters[pageQueryKey] != null)
        {
            parameters.Remove(pageQueryKey);
        }

        if (parameters.Count > 0)
        {
            queryString = "&" + parameters.ToString();
        }
    }

    Func<int, string> PageLink = n => $"{baseUrl}?{pageQueryKey}={n}{queryString}";
    var grouppage = (pageCurrent - 1) / groupsize;

    <ul class="pagination">

        @if (pageCurrent > groupsize)
        {
            <li><a href="@PageLink(1)">&lt;&lt;</a></li>
        }

        @if (pageCurrent > 1)
        {
            <li>
                <a href="@PageLink(pageCurrent - 1)">&lt;</a>
            </li>
        }

        @for (int page = grouppage * groupsize + 1; page <= pageCount + 1 && page <= (grouppage + 1) * groupsize; page++)
        {
            if (page < pageCount + 1)
            {
                if (page == pageCurrent)
                {
                    <li class="active">
                        <span>
                            @page
                        </span>
                    </li>
                }
                else
                {
                    <li>
                        <a href="@PageLink(page)">@page</a>
                    </li>
                }
            }
        }
        @if (pageCurrent + 1 <= pageCount)
        {
            <li><a href="@PageLink(pageCurrent + 1)">&gt;</a></li>
        }
        @if (grouppage < (pageCount - 1) / groupsize)
        {
            <li><a href="@PageLink(pageCount)">&gt;&gt;</a></li>
        }
    </ul>
}

